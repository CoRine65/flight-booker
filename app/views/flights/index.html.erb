<h1>Search for a Flight</h1>

<%= form_with url: flights_path, method: :get, local: true do |form| %>
  <%= hidden_field_tag :search, true %>

  <div>
    <%= label_tag :departure_airport_id, "From:" %>
    <%= select_tag :departure_airport_id, options_from_collection_for_select(@airports, :id, :code), prompt: "Choose Departure" %>
  </div>

  <div>
    <%= label_tag :arrival_airport_id, "To:" %>
    <%= select_tag :arrival_airport_id, options_from_collection_for_select(@airports, :id, :code), prompt: "Choose Arrival" %>
  </div>

  <div>
    <%= label_tag :start_date, "Date:" %>
    <%= date_field_tag :start_date %>
  </div>

  <div>
    <%= submit_tag "Search Flights" %>
  </div>
<% end %>

<% if params[:search] %>
  <h2>Results:</h2>
  <% if @flights.any? %>
    <ul>
      <% @flights.each do |flight| %>
        <li>
          <strong><%= flight.departure_airport.code %></strong> â†’ 
          <strong><%= flight.arrival_airport.code %></strong> |
          <%= flight.start_datetime.strftime("%A, %B %d at %I:%M %p") %>
          <%= link_to "Select", new_booking_path(flight_id: flight.id) %>
        </li>
      <% end %>
    </ul>
  <% else %>
    <p>No flights found for the selected date and route.</p>
  <% end %>
<% end %>

